(function(){"use strict";var e={49726:function(e,t,l){var n=l(45130),a=l(56768),o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyNpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTk2QkI4RkE3NjE2MTFFNUE4NEU4RkIxNjQ5MTYyRDgiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTk2QkI4Rjk3NjE2MTFFNUE4NEU4RkIxNjQ5MTYyRDgiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NjU2QTEyNzk3NjkyMTFFMzkxODk4RDkwQkY4Q0U0NzYiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NjU2QTEyN0E3NjkyMTFFMzkxODk4RDkwQkY4Q0U0NzYiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5WHowqAAAXNElEQVR42uxda4xd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";const r=(0,a.Lk)("img",{alt:"Vue logo",src:o},null,-1),i={id:"app"};function u(e,t,l,n,o,u){const s=(0,a.g2)("PatternEditor");return(0,a.uX)(),(0,a.CE)(a.FK,null,[r,(0,a.Lk)("div",i,[(0,a.bF)(s)])],64)}const s={class:"pattern-editor"},c={class:"scroll-container",ref:"scrollContainer"};function d(e,t,l,n,o,r){const i=(0,a.g2)("PianoRoll");return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",c,[(0,a.bF)(i)],512)])}var h=l(90144),v=l(24232);const p=e=>((0,a.Qi)("data-v-123b8b00"),e=e(),(0,a.jt)(),e),m={class:"piano-container"},k={class:"loop-wrapper"},f={key:0,class:"copyNotification"},g={key:1,class:"copyNotification",style:{"background-color":"#d44"}},y={class:"controls"},b={class:"instrument-selector"},L=p((()=>(0,a.Lk)("label",{for:"instrument-select"},"Select Instrument: ",-1))),w=["value"],M={class:"tempo-selector"},C=p((()=>(0,a.Lk)("label",{for:"tempo-select"},"Tempo: ",-1))),R={class:"grid-division-selector"},E=p((()=>(0,a.Lk)("label",{for:"grid-select"},"Grid Spacing: ",-1))),T=["value"],x={class:"piano-roll",ref:"pianoRoll"},I={class:"piano-keys"},N={class:"keys-wrapper"},W=["onMousedown","onMouseover","onMouseup","onMouseleave"],K=p((()=>(0,a.Lk)("div",{class:"marker-triangle"},null,-1))),S=p((()=>(0,a.Lk)("div",{class:"marker-line"},null,-1))),A=[K,S],G={class:"grid-wrapper"},X=["onMousedown"],V=["onMousedown"];function O(e,t,l,o,r,i){const u=(0,a.g2)("HelpMenu"),s=(0,a.g2)("Tracks");return(0,a.uX)(),(0,a.CE)("div",m,[(0,a.Lk)("button",{class:"play-button",onClick:t[0]||(t[0]=(...e)=>o.playSequence&&o.playSequence(...e))},"Play Sequence"),(0,a.Lk)("label",k,[(0,a.eW)(" Loop: "),(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=e=>o.loopSong=e)},null,512),[[n.lH,o.loopSong]])]),(0,a.bF)(u),o.showCopyNotification?((0,a.uX)(),(0,a.CE)("div",f," MML copied to clipboard! ")):(0,a.Q3)("",!0),o.showFailedNotification?((0,a.uX)(),(0,a.CE)("div",g,(0,v.v_)(o.failedNotificationText),1)):(0,a.Q3)("",!0),(0,a.bF)(s,{onTrackSelected:o.handleTrackSelected,onAddTrack:o.handleAddTrack,onRemoveTrack:o.handleRemoveTrack,onMuteTrack:o.handleMuteTrack},null,8,["onTrackSelected","onAddTrack","onRemoveTrack","onMuteTrack"]),(0,a.Lk)("div",y,[(0,a.Lk)("div",b,[L,(0,a.bo)((0,a.Lk)("select",{id:"instrument-select","onUpdate:modelValue":t[2]||(t[2]=e=>o.selectedInstrument=e),onChange:t[3]||(t[3]=(...e)=>o.changeInstrument&&o.changeInstrument(...e))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.instruments,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e},(0,v.v_)(e.name),9,w)))),128))],544),[[n.u1,o.selectedInstrument]])]),(0,a.Lk)("div",M,[C,(0,a.bo)((0,a.Lk)("input",{type:"number",id:"tempo-select","onUpdate:modelValue":t[4]||(t[4]=e=>o.tempo=e),min:"40",max:"240"},null,512),[[n.Jo,o.tempo,void 0,{number:!0}]])]),(0,a.Lk)("button",{class:"track-splitter",onClick:t[5]||(t[5]=(...e)=>o.trackify&&o.trackify(...e))},"Split Track"),(0,a.Lk)("button",{class:"MML-converter",onClick:t[6]||(t[6]=(...e)=>o.genMML&&o.genMML(...e))},"Gen MML"),(0,a.Lk)("div",R,[E,(0,a.bo)((0,a.Lk)("select",{id:"grid-select","onUpdate:modelValue":t[7]||(t[7]=e=>o.gridWidth=e)},[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)([{displayName:"16ths",width:16},{displayName:"12ths",width:256/12}],(e=>(0,a.Lk)("option",{key:e.displayName,value:e.width},(0,v.v_)(e.displayName),9,T))),64))],512),[[n.u1,o.gridWidth]])])]),(0,a.Lk)("div",x,[(0,a.Lk)("div",I,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.octaves,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:"octave"},[(0,a.Lk)("div",N,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.notes.slice().reverse(),((t,l)=>((0,a.uX)(),(0,a.CE)("div",{key:t.name,class:(0,v.C4)(["piano-key",t.isBlack?"black-key":"white-key"]),onMousedown:l=>o.startNote(0,t,e),onMouseover:l=>o.mouseOverNote(0,t,e),onMouseup:l=>o.endNote(0,t,e),onMouseleave:l=>o.mouseLeaveNote(0,t,e),style:(0,v.Tr)(t.isBlack?{zIndex:1}:{})},(0,v.v_)(t.name+e),47,W)))),128))])])))),128))]),(0,a.Lk)("div",{class:"ruler",ref:"ruler",onMousedown:t[8]||(t[8]=(...e)=>o.startMarkerDrag&&o.startMarkerDrag(...e)),style:(0,v.Tr)({width:"calc( 10% + "+o.gridSpan+"px )"})},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Math.ceil(o.gridSpan/256),(e=>((0,a.uX)(),(0,a.CE)("div",{key:e,class:"ruler-tick-label",style:(0,v.Tr)({left:`calc(${256*(e-1)}px)`})},(0,v.v_)(e),5)))),128)),(0,a.Lk)("div",{class:"marker-replay-triangle",style:(0,v.Tr)({left:o.markerReplayPosition+"px"})},null,4),(0,a.Lk)("div",{class:"marker-wrapper",style:(0,v.Tr)({left:o.markerPosition+"px"})},A,4)],36),(0,a.Lk)("div",G,[(0,a.Lk)("div",{class:"grid",ref:"grid",style:(0,v.Tr)({width:o.gridSpan+"px",background:o.backgroundStyle.background}),onMousedown:t[10]||(t[10]=(0,n.D$)(((...e)=>o.handleGridClick&&o.handleGridClick(...e)),["left"])),onContextmenu:t[11]||(t[11]=(0,n.D$)(((...t)=>e.startNoteRemove&&e.startNoteRemove(...t)),["prevent"]))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.notesInGrid,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"note",style:(0,v.Tr)({left:e.left+"px",top:e.top+"px",width:e.width+"px",height:o.gridHeight+"px",visibility:e.muted?"hidden":"visible",pointerEvents:e.muted?"none":"auto",backgroundColor:e.color,border:`${e.highlighted?2:1}px solid ${e.highlighted?"white":e.color}`}),onMousedown:[(0,n.D$)((t=>o.startDrag(e,t)),["left"]),(0,n.D$)((t=>o.removeNote(e,!1)),["right","prevent"])],onMouseup:t[9]||(t[9]=(0,n.D$)(((...e)=>o.endDrag&&o.endDrag(...e)),["left"]))},[(0,a.Lk)("div",{class:"resize-handle",onMousedown:t=>o.startResize(e,t)},null,40,V),(0,a.eW)(" "+(0,v.v_)(e.name),1)],44,X)))),128)),o.isSelecting?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"selection-rect",style:(0,v.Tr)(o.rectangleStyle)},null,4)):(0,a.Q3)("",!0)],36)])],512)])}l(44114);var z=l(76393);const B=e=>((0,a.Qi)("data-v-5eb8416a"),e=e(),(0,a.jt)(),e),P={key:0},D={key:1},Q={key:0,class:"modal-background"},U={class:"help-modal"},Z=B((()=>(0,a.Lk)("div",{class:"help-content"},[(0,a.Lk)("h1",null,"Help"),(0,a.Lk)("h3",null,"Placing Notes"),(0,a.Lk)("li",null,"To place notes, click anywhere on the grid."),(0,a.Lk)("li",null,"The size of the note will be the same size as the note that was last placed/moved."),(0,a.Lk)("li",null,"Placed notes are instantly draggable."),(0,a.Lk)("li",null,"The color of the placed notes will depend on the color of the track they belong to."),(0,a.Lk)("li",null,'By changing the "Grid Spacing" dropdown, you can control whether the grid is in 16ths or 12ths.'),(0,a.Lk)("h3",null,"Dragging Notes"),(0,a.Lk)("li",null,"To drag a note, click on the left side of the note. Then, move your mouse around within the bounds of the grid."),(0,a.Lk)("li",null,[(0,a.eW)("Holding "),(0,a.Lk)("strong",null,"Alt"),(0,a.eW)(" will move notes freely (not locked to the grid).")]),(0,a.Lk)("li",null,"If multiple notes are selected, all selected notes will be moved together (even if they are from different tracks)."),(0,a.Lk)("h3",null,"Resizing Notes"),(0,a.Lk)("li",null,"To resize a note, click on the right side of the note, then drag left or right."),(0,a.Lk)("li",null,"Notes have a minimum length of 1/64th of a beat."),(0,a.Lk)("li",null,[(0,a.eW)("Holding "),(0,a.Lk)("strong",null,"Alt"),(0,a.eW)(" will resize notes freely (not locked to the grid)")]),(0,a.Lk)("li",null,"If multiple notes are selected, all selected notes will be resized together."),(0,a.Lk)("h3",null,"Selecting Multiple Notes"),(0,a.Lk)("li",null,[(0,a.eW)("To select multiple notes at once, hold "),(0,a.Lk)("strong",null,"Ctrl"),(0,a.eW)(" on the grid and drag your mouse.")]),(0,a.Lk)("li",null,[(0,a.eW)("If you hold "),(0,a.Lk)("strong",null,"Ctrl+Shift"),(0,a.eW)(' and drag, you will "add on" to your note selection. '),(0,a.Lk)("i",null,"(Previously selected notes will not be unselected, and you can select additional notes.)")]),(0,a.Lk)("li",null,[(0,a.eW)("If you hold "),(0,a.Lk)("strong",null,"Shift"),(0,a.eW)(" and drag a note, you will clone it (if that note is highlighted, it will clone all highlighted notes).")]),(0,a.Lk)("li",null,[(0,a.eW)("Pressing "),(0,a.Lk)("strong",null,"Ctrl+A"),(0,a.eW)(" will select all notes in the grid.")]),(0,a.Lk)("li",null,[(0,a.eW)("Pressing the "),(0,a.Lk)("strong",null,"Backspace"),(0,a.eW)(" or "),(0,a.Lk)("strong",null,"Delete"),(0,a.eW)(" keys will delete all selected notes.")]),(0,a.Lk)("h3",null,"Tracks"),(0,a.Lk)("li",null,"Each track has its own name, instrument, color, and visibility toggle."),(0,a.Lk)("li",null,"To add a track, click on the blue plus button to the right of the tracks."),(0,a.Lk)("li",null,[(0,a.eW)("To rename a track, double click on the track's name. When done with renaming, press "),(0,a.Lk)("strong",null,"Enter"),(0,a.eW)(".")]),(0,a.Lk)("li",null,"To mute/unmute a track, click on the volume icon next to the track's name."),(0,a.Lk)("li",null,"Clicking on a note from another track will cause you to switch to that note's track."),(0,a.Lk)("li",null,[(0,a.eW)("You can remove a track by clicking on the "),(0,a.Lk)("strong",null,"X"),(0,a.eW)(". This will also remove the notes belonging to that track.")]),(0,a.Lk)("li",null,"To change the color of a track and its notes, click on the outlined box at the bottom-center of the selected track's tab."),(0,a.Lk)("li",null,"You can have a minimum of 1 track, and a maximum of 16 tracks."),(0,a.Lk)("li",null,"The number of tracks you can have at once is dependant on screen width. This is so that smaller screens can still access all of their created tabs easily."),(0,a.Lk)("li",null,"Hovering over a track tab will show you the name of the track."),(0,a.Lk)("h3",null,"Track Splitting"),(0,a.Lk)("li",null,'With a track selected, click the "Split Track" button. This will separate the track into multiple other tracks (unless that number would exceed 16).'),(0,a.Lk)("li",null,"A track is split from left to right, then top to bottom. This can sometimes lead to weird splits."),(0,a.Lk)("li",null,"The purpose of this feature is so that you can compose parts of your piece in a single track, then split them up if you need to."),(0,a.Lk)("h3",null,"Exporting to MML"),(0,a.Lk)("li",null,'Clicking on the "Convert to MML" button will copy the MML of audible tracks to your clipboard.'),(0,a.Lk)("li",null,"Only unmuted/audible tracks will be copied to your clipboard."),(0,a.Lk)("li",null,"A maximum of four tracks can be exported at once."),(0,a.Lk)("li",null,"Remember that the fourth track in a score is always the 'song' track."),(0,a.Lk)("li",null,"Tracks that have multiple notes playing at once will NOT export properly, so be sure to split them before export."),(0,a.Lk)("li",null,"The exported MML will be moderately optimized for length, but don't expect them to be perfect."),(0,a.Lk)("li",null,"Tracks will be exported sorted by number of notes. If a track has more notes, then it will be first."),(0,a.Lk)("li",null,"Currently, exported MMLs will be at max volume (V15) in all tracks."),(0,a.Lk)("li",null,"Currently, exported MMLs will always have the tempo specified in the first exported (longest) track."),(0,a.Lk)("h3",null,"Misc"),(0,a.Lk)("li",null,[(0,a.eW)("Click and hold on the piano keys to play them. "),(0,a.Lk)("br"),(0,a.Lk)("em",null,"(Note: some instruments can only play certain keys)")]),(0,a.Lk)("li",null,[(0,a.eW)("Press "),(0,a.Lk)("strong",null,"Space"),(0,a.eW)(" to play your song. It will start from the marker.")]),(0,a.Lk)("li",null,[(0,a.eW)("Press "),(0,a.Lk)("strong",null,"Space"),(0,a.eW)(" again to pause your song. If you press "),(0,a.Lk)("strong",null,"Ctrl+Space"),(0,a.eW)(", it will stop the marker where it was.")]),(0,a.Lk)("li",null,[(0,a.eW)("Check the "),(0,a.Lk)("strong",null,"Loop"),(0,a.eW)(" checkbox to loop your song.")]),(0,a.Lk)("li",null,"Click and drag on the timeline to move the marker."),(0,a.Lk)("li",null,[(0,a.eW)("If you hold "),(0,a.Lk)("strong",null,"ALT"),(0,a.eW)(" while dragging, the marker will move freely.")]),(0,a.Lk)("li",null,"You can change instruments using the spinner at the top left of the page."),(0,a.Lk)("li",null,"You can change the tempo by entering a number at the top left of the page."),(0,a.Lk)("h3",null,"Planned Features"),(0,a.Lk)("li",null,"Support for tempo and note volume changes"),(0,a.Lk)("li",null,"MML import"),(0,a.Lk)("li",null,"MIDI import/export support"),(0,a.Lk)("li",null,'Support for saving/loading "projects"'),(0,a.Lk)("li",null,"Undo/Redo functionality"),(0,a.Lk)("li",null,"Copy/Paste functionality"),(0,a.Lk)("p",{class:"credits"},"Credits: Made by Daderic")],-1)));function Y(e,t,l,o,r,i){return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("button",{class:"help-button",onClick:t[0]||(t[0]=(...e)=>i.showHelp&&i.showHelp(...e))},[r.hoverHelp?((0,a.uX)(),(0,a.CE)("span",P,"Help")):((0,a.uX)(),(0,a.CE)("span",D," ? "))]),r.isHelpVisible?((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.bF)(n.eB,{name:"fade"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",U,[(0,a.Lk)("button",{class:"close-button",onClick:t[1]||(t[1]=(...e)=>i.closeHelp&&i.closeHelp(...e))},"X"),Z])])),_:1})])):(0,a.Q3)("",!0)])}var H={data(){return{hoverHelp:!1,isHelpVisible:!0}},methods:{showHelp(){this.isHelpVisible=!0},closeHelp(){this.isHelpVisible=!1}}},F=l(71241);const J=(0,F.A)(H,[["render",Y],["__scopeId","data-v-5eb8416a"]]);var j=J;const q={class:"track-tab-container",ref:"tabContainerRef"},_=["onClick","title"],$={class:"tab-header"},ee=["onUpdate:modelValue","onBlur","onKeyup"],te=["onDblclick"],le=["onClick"],ne=["onClick"],ae={key:0,class:"color-picker-container"},oe=["disabled"];function re(e,t,l,o,r,i){return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("div",q,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.tracks,((e,l)=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:(0,v.C4)(["track-tab",{selected:o.selectedTrackIndex===l}]),onClick:e=>o.selectTrack(l),style:(0,v.Tr)({backgroundColor:e.color}),title:e.name},[(0,a.Lk)("div",$,[e.isEditingName?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:0,"onUpdate:modelValue":t=>e.name=t,onBlur:t=>e.isEditingName=!1,onKeyup:(0,n.jR)((t=>e.isEditingName=!1),["enter"]),class:"track-name-input"},null,40,ee)),[[n.Jo,e.name]]):((0,a.uX)(),(0,a.CE)("span",{key:1,onDblclick:t=>e.isEditingName=!0,class:"track-name"},(0,v.v_)(e.name),41,te)),(0,a.Lk)("span",{class:"mute-icon",onClick:(0,n.D$)((e=>o.toggleMute(l)),["stop"])},(0,v.v_)(e.isMuted?"🔇":"🔊"),9,le),(0,a.Lk)("button",{onClick:(0,n.D$)((e=>o.removeTrack(l)),["stop"]),class:"delete-btn"},"✖",8,ne)]),o.selectedTrackIndex===l?((0,a.uX)(),(0,a.CE)("div",ae,[(0,a.bo)((0,a.Lk)("input",{type:"color","onUpdate:modelValue":t[0]||(t[0]=e=>o.trackHexColor=e),class:"color-picker",onInput:t[1]||(t[1]=(...e)=>o.updateTrackColor&&o.updateTrackColor(...e))},null,544),[[n.Jo,o.trackHexColor]])])):(0,a.Q3)("",!0)],14,_)))),128)),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.addTrack&&o.addTrack(...e)),class:"add-track-btn",disabled:!o.canAddTrack}," + ",8,oe)],512)])}const ie=(0,h.Kh)({}),ue=(0,h.KR)([]),se=(0,h.KR)(null),ce=(0,a.EW)((()=>ue.value[se.value]||null)),de=(0,h.KR)("#ffffff");var he={created(){ie.addTrack=this.addTrack},setup(e,{emit:t}){const l=(0,h.KR)(0),n=(0,h.KR)(null),o=(0,a.EW)((()=>{if(ue.value.length>15)return!1;const e=75,t=ue.value.length*e;return l.value-t-50>e})),r=()=>{n.value&&(l.value=n.value.clientWidth)},i=()=>{const e=Math.floor(360*Math.random()),t=75+25*Math.random(),l=50+10*Math.random(),n=(1-Math.abs(2*l/100-1))*(t/100),a=n*(1-Math.abs(e/60%2-1)),o=l/100-n/2;let[r,i,u]=e<60?[n,a,0]:e<120?[a,n,0]:e<180?[0,n,a]:e<240?[0,a,n]:e<300?[a,0,n]:[n,0,a];return r=Math.round(255*(r+o)),i=Math.round(255*(i+o)),u=Math.round(255*(u+o)),`#${((1<<24)+(r<<16)+(i<<8)+u).toString(16).slice(1)}`},u=(e=null,l=null,n=null)=>{const a={id:Date.now(),name:n||`Track ${ue.value.length+1}`,isMuted:!1,color:l||i(),isEditingName:!1,notes:[],instrument:e||{name:"Lute",program:0}};return ue.value.push(a),c(ue.value.length-1),t("add-track",a,ue.value.length-1),a},s=e=>{if(1===ue.value.length)return;let l=ue.value[e];if(ue.value.splice(e,1),0===ue.value.length)se.value=null,de.value="#ffffff";else{if(e===se.value){const t=e<ue.value.length?e:e-1;se.value=t,de.value=ue.value[t].color}else se.value>e&&se.value--;ce.value&&(de.value=ce.value.color)}t("remove-track",l,ce.value)},c=e=>{se.value=e,de.value=ue.value[e].color,t("track-selected",ue.value[e])},d=e=>{if(ue.value[e].isMuted=!ue.value[e].isMuted,ue.value[e].isMuted)for(const t of ue.value[e].notes)t.muted=!0;else for(const t of ue.value[e].notes)t.muted=!1;t("mute-track")},v=e=>{const t=e.target.value;if(ce.value){ce.value.color=t,de.value=t;for(const e of ce.value.notes)e.color=t}};return(0,a.sV)((()=>{u(),(0,a.dY)((()=>{r()})),window.addEventListener("resize",r)})),(0,a.xo)((()=>{window.removeEventListener("resize",r)})),{tracks:ue,selectedTrackIndex:se,trackHexColor:de,containerWidth:l,addTrack:u,removeTrack:s,selectTrack:c,toggleMute:d,updateTrackColor:v,selectedTrack:ce,canAddTrack:o,tabContainerRef:n}}};const ve=(0,F.A)(he,[["render",re],["__scopeId","data-v-46554816"]]);var pe=ve,me=(l(44847),{name:"PianoRoll",components:{HelpMenu:j,Tracks:pe},setup(){const e="../MabiMML/",t=(0,h.KR)(null),l=(0,h.KR)(null),n=(0,h.KR)(null),o=(0,h.KR)(null),r=(0,h.KR)(!1),i=(0,h.KR)({name:"Lute",program:0}),u=(0,h.KR)(null),s=(0,h.KR)(120),c=(0,h.KR)(!1),d=(0,h.KR)([{name:"Lute",program:0},{name:"Ukulele",program:1},{name:"Mandolin",program:2},{name:"Whistle",program:3},{name:"Roncadora",program:4},{name:"Flute",program:5},{name:"Chalumeau",program:6},{name:"Tuba",program:18},{name:"Lyre",program:19},{name:"Electric Guitar",program:20},{name:"Piano",program:21},{name:"Violin",program:22},{name:"Cello",program:23},{name:"Harp",program:24},{name:"Tuned Violin",program:25},{name:"Tuned Cello",program:26},{name:"Drum Kit",program:27},{name:"Festival Lute",program:50},{name:"Festival Ukulele",program:51},{name:"Festival Mandolin",program:52},{name:"Festival Whistle",program:53},{name:"Festival Flute",program:54},{name:"Bass Drum",program:66},{name:"Snare Drum",program:67},{name:"Cymbals",program:68},{name:"Hand Chimes",program:107},{name:"Female Chorus",program:110},{name:"Male Chorus",program:111},{name:"Male Voice",program:120},{name:"Female Voice",program:121}]);let v=(0,h.KR)(16);const p=(0,h.KR)(16),m=24,k=(0,h.KR)([]),f=(0,h.KR)([]),g=(0,h.KR)([]),y=(0,h.KR)(0),b=(0,h.KR)(0),L=((0,h.KR)(0),(0,h.KR)(0),(0,h.KR)(0),(0,h.KR)(window.innerWidth)),w=(0,h.KR)(0),M=(0,h.KR)([]),C=(0,h.KR)(!1),R=(0,h.KR)(0),E=(0,h.KR)(0),T=(0,h.KR)(null),x=(0,h.KR)(0),I=(0,h.KR)(0),N=(0,h.KR)(null),W=(0,h.KR)(!1),K=(0,a.EW)((()=>({left:`${Math.min(y.value,R.value)}px`,top:`${Math.min(b.value,E.value)}px`,width:`${Math.abs(R.value-y.value)}px`,height:`${Math.abs(E.value-b.value)}px`,backgroundColor:"rgba(0, 100, 255, 0.3)",border:"1px solid rgba(0, 100, 255, 0.5)"}))),S=(0,a.EW)((()=>({background:`repeating-linear-gradient( /*This is the horizontal lines*/\n                0deg,\n                #bbb,\n                #bbb 2px,\n                transparent 2px,\n                transparent 24px\n            ),\n            repeating-linear-gradient( /*This is the Bar line*/\n                90deg,\n                #777,\n                #777 2px,\n                transparent 2px,\n                transparent 256px\n            ),\n            repeating-linear-gradient( /*This is the vertical lines*/\n                90deg,\n                #c0c0c0,\n                #c0c0c0 2px,\n                transparent 2px,\n                transparent ${p.value}px\n            ),\n            repeating-linear-gradient(/*This is the background colors*/\n                90deg,\n                #e0e0e0,\n                #e0e0e0 64px,\n                #ccc 64px,\n                #ccc 128px\n            )`}))),A=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],G=["C#","D#","F#","G#","A#"],X=(0,h.KR)(A.map(((e,t)=>({name:e,index:t,isBlack:G.includes(e)})))),V=(0,h.KR)([0,1,2,3,4,5,6,7,8]),O=(0,h.KR)(!1),B=(0,h.KR)(!1),P=(0,h.KR)("");(0,a.nT)((()=>{const e=Math.max(...k.value.map((e=>e.left+e.width)),0);L.value=Math.max(e+window.innerWidth,window.innerWidth)}));const D=(e,t,l)=>ie.addTrack(e,t,l),Q=e=>{i.value=e.instrument,se.value=ue.value.indexOf(e),ye()},U=async(e,t)=>{},Z=async(e,t)=>{for(const l of e.notes)Ue(l,!0)},Y=async()=>{W.value&&pe()},H=async t=>{try{const t=await fetch(e+"soundfonts/mabi_instruments_high_quality.sf3"),l=await t.arrayBuffer();return l}catch(l){return console.error("Failed to load SoundFont:",l),null}};(0,a.sV)((async()=>{try{const t=document.querySelector(".grid-wrapper");t&&(t.addEventListener("scroll",he),he()),document.addEventListener("keydown",re),o.value=new AudioContext,await o.value.audioWorklet.addModule(e+"worklet_processor.min.js");const l=await H(i.value);if(!l)return;n.value=new z.gV(o.value.destination,l,!0,void 0,{chorusEnabled:!1,reverbEnabled:!1}),await n.value.isReady}catch(t){console.error("Error initializing sequencer or synthesizer:",t)}}));const F=e=>{W&&ve(),oe(e.clientX,e.altKey,!0),document.addEventListener("mousemove",J),document.addEventListener("mouseup",j)},J=e=>{oe(e.clientX,e.altKey,!0)},j=async()=>{document.removeEventListener("mousemove",J),document.removeEventListener("mouseup",j)};let q,_,$;async function ee(){W.value=!0,_=x.value,$=s.value,te()}function te(){function e(){x.value=4*N.value.currentTime*16*$/60+_,N.value&&!c.value&&(N.value.loop=c.value)}clearInterval(q),e(),q=setInterval(e,62.5/(s.value/120))}function le(e){let t="",l=e,n=[];for(let o=1;o<=64;++o)if(o<12||o%12===0||o%16===0){let e=Math.round(256/o*100),t=Math.round(256/o*150);n.push({length:t,name:"L"+o+"."}),n.push({length:e,name:"L"+o})}let a=ne(n,l);return t=a.noteCombination.map((e=>e.name)).join("&"),t}function ne(e,t){let l=Math.round(100*t);const n=new Array(l+1).fill(1/0);n[0]=0;const a=new Array(l+1).fill(-1);for(let i=1;i<=l;i++)for(const t of e){const e=t.length;i>=e&&n[i-e]+1<n[i]&&(n[i]=n[i-e]+1,a[i]=t)}if(n[l]===1/0)return{minNotes:null,noteCombination:[]};const o=[];let r=l;while(r>0){const e=a[r];o.push(e),r-=e.length}return{minNotes:n[l],noteCombination:o}}const ae=()=>{clearInterval(q),W.value=!1},oe=(e,t,l)=>{if(T.value){const n=T.value.getBoundingClientRect();let a=e-n.left;t||(a=Math.round(a/p.value)*p.value),a=Math.max(0,Math.min(L.value,a)),x.value=a,l&&(I.value=a)}};function re(e){if("Backspace"===e.key||"Delete"===e.key){for(const e of M.value)Ue(e,!0);W.value&&pe()}if("Space"===e.code)e.preventDefault(),W.value?(ve(),e.ctrlKey||(x.value=I.value)):pe();else if("a"===e.key&&e.ctrlKey&&!ce.value.isEditingName){e.preventDefault();for(const e of k.value)Ae(e)}}function he(){const e=document.querySelector(".grid-wrapper"),t=document.querySelector(".ruler");e&&t&&(w.value=e.scrollLeft,t.style.left=-w.value+"px")}function ve(){N.value&&N.value.stop(),ae(),n.value.programChange(0,i.value.program)}const pe=async(e=null)=>{try{if(e&&W.value)return ve(),void(x.value=I.value);if(u.value=new z.Hm("untitled",480,s.value),await o.value.resume(),!n.value)return;let t=0,l=[];for(const e of ue.value)e.isMuted||(l.push(e),u.value.addNewTrack(e.name+ue.value.indexOf(e)));if(k.value.forEach((e=>{if(!e.muted&&e.left+e.width>=x.value){let n=null;for(const t of ue.value)t.notes.some((t=>t.id===e.id))&&(n=t);const a=l.indexOf(n),o=a,r=e.pitch,i=e.left/16*120,s=(e.width+1)/16*120,c=x.value/16*120,d=Math.max(i,c)-c,h=Math.min(s,i+s-c),v=Math.max(0,Math.min(127,8*(e.volume+1)-1));u.value.addEvent(d,a,192|15&o,[n.instrument.program]),u.value.addNoteOn(d,a,o,r,v),u.value.addNoteOff(d+h-1,a,o,r),t++}})),0===t)return;u.value.flush();const a=await(0,z.Nt)(u.value);N.value=new z.YC([{binary:a}],n.value),N.value.loop=c.value&&0===x.value,await n.value.isReady,N.value.skipToFirstNoteOn=!1,N.value.addOnSongEndedEvent((()=>{ae(),x.value=I.value,c.value&&!N.value.loop&&(x.value=0,pe())}),"test2"),await N.value.play(),ee()}catch(t){console.error("Error playing sequence: ",t)}},me=async(e,t,l)=>{try{o.value.resume(),await n.value.isReady,n.value.noteOn(e,t.index+12*(l+1),127,!1)}catch(a){console.error(a)}},ke=async(e,t,l)=>{try{await n.value.isReady,n.value&&n.value.noteOff(e,t.index+12*(l+1))}catch(a){console.error(a)}},fe=(e,t,l)=>{r.value&&0===f.value.length&&0===g.value.length&&me(e,t,l)},ge=(e,t,l)=>{r.value&&0===f.value.length&&0===g.value.length&&ke(e,t,l)},ye=async()=>{n.value&&i.value&&(ce.value.instrument=i.value,n.value.programChange(0,i.value.program),W.value&&pe(),await n.value.isReady)},be=new Map,Le=(e,t,l=!0)=>{if(t.preventDefault(),0===t.button&&0===g.value.length){if(e.highlighted?f.value=M.value:(Ie(),f.value.push(e)),t.shiftKey&&l)for(const e of f.value){const t={id:k.value.length+Date.now(),name:e.name,left:e.left,top:e.top,pitch:e.pitch,width:e.width,length:e.length,highlighted:!1,color:e.color,start:e.start,end:e.end,volume:15,muted:!1,track:e.track};k.value.push(t),t.track.notes.unshift(t)}for(const e of f.value)be.set(e.id,{x:t.clientX,y:t.clientY,left:e.left,top:e.top});v.value=e.length,se.value=ue.value.indexOf(e.track),de.value=e.track.color,document.addEventListener("mousemove",we),document.addEventListener("mouseup",Me)}},we=e=>{if(f.value&&0===g.value.length){let t=!1;const l=[];for(const n of f.value){const a=be.get(n.id);if(!a)continue;const o=e.clientX-a.x,r=e.clientY-a.y;let i=0;i=e.altKey||n.highlighted&&(n.width+1)%p.value!==0?Math.round((a.left+o)/(p.value/4))*(p.value/4):Math.round((a.left+o)/p.value)*p.value;let u=Math.round((a.top+r)/m)*m;if(i<0||u<0||u>2568){t=!0;break}l.push({note:n,newLeft:i,newTop:u})}if(t)return;for(const{note:e,newLeft:n,newTop:a}of l){e.left=n,e.top=a;const t=(1284-e.top/2)/144,l=A[12*t%12]+""+Math.floor(t);e.name!=l&&1===f.value.length&&(me(0,{name:l,index:12*t%12},Math.floor(t)),ke(0,{name:l,index:12*t%12},Math.floor(t))),e.name=l,e.pitch=12*t%12+12*(Math.floor(t)+1)}}},Me=()=>{W.value&&pe(),f.value=[],document.removeEventListener("mousemove",we),document.removeEventListener("mouseup",Me),be.clear()},Ce=new Map,Re=(e,t)=>{t.preventDefault(),0===t.button&&(g.value=[],y.value=t.clientX,Ce.clear(),e.highlighted?(M.value.forEach((e=>{Ce.set(e.id,{width:e.width,startX:t.clientX})})),g.value=M.value):(Ie(),Ce.set(e.id,{width:e.width,startX:t.clientX}),g.value=[e]),document.addEventListener("mousemove",Ee),document.addEventListener("mouseup",Te))},Ee=e=>{if(g.value.length>0){let t=!0;const l=[];if(g.value.forEach((n=>{const a=Ce.get(n.id);if(!a)return;const o=e.clientX-a.startX;let r=0;r=e.altKey?Math.round((a.width+o)/(p.value/4))*p.value/4-1:Math.round((a.width+o)/p.value)*p.value-1,r<p.value-1&&!e.altKey||r<3?t=!1:l.push({note:n,newWidth:r})})),t)for(const{note:e,newWidth:n}of l)e.width=n,e.length=(n+1)/p.value,v.value=e.length}},Te=()=>{g.value=[],Ce.clear(),document.removeEventListener("mousemove",Ee),document.removeEventListener("mouseup",Te)},xe=e=>{e.ctrlKey&&f.value.length<=0?(e.shiftKey||Ie(),Ne(e)):Xe(e)};function Ie(){M.value.forEach((e=>{e.highlighted=!1})),M.value=[]}const Ne=e=>{e.preventDefault(),C.value=!0;const t=l.value.getBoundingClientRect();y.value=e.clientX-t.left,b.value=e.clientY-t.top,R.value=e.clientX-t.left,E.value=e.clientY-t.top,document.addEventListener("mousemove",We),document.addEventListener("mouseup",Ke)},We=e=>{if(C.value){const t=l.value.getBoundingClientRect();R.value=e.clientX-t.left,E.value=e.clientY-t.top}},Ke=()=>{C.value&&(C.value=!1,document.removeEventListener("mousemove",We),document.removeEventListener("mouseup",Ke),Se())};function Se(){const e={left:Math.min(y.value,R.value),top:Math.min(b.value,E.value),right:Math.max(y.value,R.value),bottom:Math.max(b.value,E.value)};k.value.forEach((t=>{const l={left:t.left,top:t.top,right:t.left+t.width,bottom:t.top+m};Ge(e,l)&&Ae(t)}))}function Ae(e){M.value.includes(e)||e.muted||(M.value.push(e),e.highlighted=!0)}function Ge(e,t){return!(t.left>=e.right||t.right<=e.left||t.top>=e.bottom||t.bottom<=e.top)}const Xe=e=>{if(f.value.length>0||g.value.length>0)return;const t=l.value,n=t.getBoundingClientRect(),a=e.clientX-n.left+t.scrollLeft,o=e.clientY-n.top+t.scrollTop,r=Math.round((a-p.value/2)/p.value)*p.value,i=Math.round((o-m/2)/m)*m,u=(1284-i/2)/144,s=A[12*u%12]+""+Math.floor(u);me(0,{name:s,index:12*u%12},Math.floor(u)),ke(0,{name:s,index:12*u%12},Math.floor(u));const c=k.value.find((e=>e.left===r&&e.top===i&&!e.muted));if(c)Le(c,e);else{Ie();const t=k.value.length+Date.now(),l={left:r,top:i,width:p.value*v.value-1,highlighted:!1,color:ce.value?ce.value.color:"hsla(212, 100%, 50%, 0.5)",id:t,name:s,pitch:12*u%12+12*(Math.floor(u)+1),length:v.value,start:r/p.value,end:r/p.value+v.value,volume:15,track:ce.value};k.value.push(l),ce.value.notes.unshift(l),Le(k.value.find((e=>e.id==t)),e,!1)}},Ve=()=>{let e=[...ce.value.notes].sort(((e,t)=>e.left===t.left?e.top-t.top:e.left-t.left)),t=[];t.push({notes:[],track:ce.value,index:0});for(const l of e)for(const e of t){if(!e.notes[0]||e.notes[0].left+e.notes[0].width<l.left){e.notes.unshift(l);break}e.index===t.length-1&&t.push({notes:[],track:{instrument:e.track.instrument,color:null,name:ce.value.name+` (${t.length})`},index:t.length})}if(ue.value.length+t.length-1>16)return B.value=!0,P.value="Failed to split track! (Process would create too many tracks!)",void setTimeout((()=>{B.value=!1}),2e3);for(const l of t){ue.value.includes(l.track)||(l.track=D(l.track.instrument,l.track.color,l.track.name)),l.track.notes=l.notes;for(const e of l.track.notes)e.track=l.track,e.color=l.track.color}};function Oe(e){navigator.clipboard.writeText(e).then((()=>{O.value=!0,setTimeout((()=>{O.value=!1}),2e3)})).catch((e=>{console.error("Could not copy text: ",e)}))}const ze=()=>{for(const a of ue.value)a.notes.sort(((e,t)=>e.left===t.left?e.top-t.top:e.left-t.left)),a.notes.reverse();let e="",t=[];for(const a of ue.value)a.isMuted||t.push(a);if(!(0<=t.length&&t.length<=4))return console.log("Could Not Gen MML"),B.value=!0,P.value="Failed to copy MML to clipboard! Too many tracks visible!",setTimeout((()=>{B.value=!1}),2e3),null;t.sort(((e,t)=>t.notes.length-e.notes.length)),console.log(t);for(const a of t){let t=0;for(const l of a.notes.slice().reverse()){if(l.left>t+4){let n=l.left-t,a=le(n);a=a.replaceAll("L","R"),e+=a}let n=le(l.width+1);if(n.includes("&")){let t=n.split("&");for(let n=0;n<t.length;++n)e+=t[n]+"N"+(l.pitch-12)+(n===t.length-1?"":"&")}else e+=le(l.width+1)+"N"+(l.pitch-12);t=l.left+l.width+1}e+=","}e=e.slice(0,-1);let l=e.split(","),n=[];for(const a of l){let e=Pe(a),t=De(e),l=Qe(t);n.push(l)}e=`MML@T${s.value}V15${n.join(",V15")};`,console.log(e),Oe(e)},Be={LENGTH:/L(\d+)\.?/g,NOTE:/[A-G][-+#]?\d*\.?|N\d+/g,REST:/R\d+\.?/g,TIE:/&/g,OCTAVE:/O(\d+)|[<>]/g};function Pe(e){let t=[];for(const[l,n]of Object.entries(Be)){let a;while(null!==(a=n.exec(e)))t.push({type:l,value:a[0],index:a.index})}return t.sort(((e,t)=>e.index-t.index)),t}function De(e){let t=JSON.parse(JSON.stringify(e)),l=2;for(let n=0;n<l;++n){let e=4,l="4";for(let n=0;n<t.length;++n){let a=t[n];if("LENGTH"===a.type){let e=a.value.split("L")[1];e!==l?l=e:(t.splice(n,1),n--)}else if("REST"===a.type){let e=a.value.split("R")[1];e===l&&(a.value="R")}else if("NOTE"===a.type){if(!a.value.includes("N"))continue;let l=Number(a.value.split("N")[1]),o=Math.floor(l/12),r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],i=r[l-12*o];if(o!==e){let l=o-e,r=[];if(Math.abs(l)<3){let e=l>0?">":"<";for(let t=0;t<Math.abs(l);++t)r.push({type:"OCTAVE",value:e,index:a.index+t})}else r=[{type:"OCTAVE",value:"O"+o,index:a.index}];t.splice(n,1,...r,{type:"NOTE",value:i,index:a.index+r.length}),e=o}else a.value=i}}for(let n=0;n<t.length;++n){let e=t[n],l=n>0?t[n-1]:null;if("LENGTH"===e.type){let a=0,o=[];for(let e=n+1;e<t.length;++e){let l=t[e];if("NOTE"!==l.type&&"REST"!==l.type||""!==l.value.replace(/[A-GRN][#]?/g,"")){if("LENGTH"===l.type)break}else a++,o.push(e)}if(l&&"TIE"===l.type||a*e.value.length<=e.value.length+a){for(const l of o)t[l].value=t[l].value+e.value.split("L")[1];t.splice(n,1)}}}}return t}function Qe(e){let t="";for(const l of e)t+=l.value;return t}const Ue=(e,t)=>{M.value=M.value.filter((t=>t.id!==e.id));let l=k.value.length;k.value=k.value.filter((t=>t.id!==e.id));k.value.length;for(const n of ue.value)n.notes=n.notes.filter((t=>t.id!==e.id));!t&&W.value&&pe()};return document.addEventListener("mousedown",(e=>{r.value=!0})),document.addEventListener("mouseup",(()=>{r.value=!1})),{notes:X,octaves:V,startNote:me,endNote:ke,mouseOverNote:fe,mouseLeaveNote:ge,instruments:d,selectedInstrument:i,changeInstrument:ye,pianoRoll:t,grid:l,notesInGrid:k,startDrag:Le,endDrag:Me,startPlacingNote:Xe,removeNote:Ue,gridWidth:p,gridHeight:m,gridSpan:L,startResize:Re,endResize:Te,onResize:Ee,currentNoteLength:v,playSequence:pe,tempo:s,handleGridClick:xe,isSelecting:C,rectangleStyle:K,startMarkerDrag:F,markerPosition:x,markerReplayPosition:I,ruler:T,loopSong:c,trackify:Ve,noteWidthToMML:le,backgroundStyle:S,genMML:ze,showCopyNotification:O,showFailedNotification:B,failedNotificationText:P,handleTrackSelected:Q,handleAddTrack:U,handleRemoveTrack:Z,handleMuteTrack:Y}}});const ke=(0,F.A)(me,[["render",O],["__scopeId","data-v-123b8b00"]]);var fe=ke;var ge={name:"PatternEditor",components:{PianoRoll:fe},setup(){const e=(0,h.KR)(null);return{scrollContainer:e}}};const ye=(0,F.A)(ge,[["render",d],["__scopeId","data-v-233a7f0a"]]);var be=ye,Le={name:"App",components:{PatternEditor:be}};const we=(0,F.A)(Le,[["render",u]]);var Me=we;(0,n.Ef)(Me).mount("#app")}},t={};function l(n){var a=t[n];if(void 0!==a)return a.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,l),o.exports}l.m=e,function(){var e=[];l.O=function(t,n,a,o){if(!n){var r=1/0;for(c=0;c<e.length;c++){n=e[c][0],a=e[c][1],o=e[c][2];for(var i=!0,u=0;u<n.length;u++)(!1&o||r>=o)&&Object.keys(l.O).every((function(e){return l.O[e](n[u])}))?n.splice(u--,1):(i=!1,o<r&&(r=o));if(i){e.splice(c--,1);var s=a();void 0!==s&&(t=s)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[n,a,o]}}(),function(){l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,{a:t}),t}}(),function(){l.d=function(e,t){for(var n in t)l.o(t,n)&&!l.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){l.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){l.p="/MabiMML/"}(),function(){l.b=document.baseURI||self.location.href;var e={524:0};l.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,o,r=n[0],i=n[1],u=n[2],s=0;if(r.some((function(t){return 0!==e[t]}))){for(a in i)l.o(i,a)&&(l.m[a]=i[a]);if(u)var c=u(l)}for(t&&t(n);s<r.length;s++)o=r[s],l.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return l.O(c)},n=self["webpackChunkmusic_sequencer"]=self["webpackChunkmusic_sequencer"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=l.O(void 0,[504],(function(){return l(49726)}));n=l.O(n)})();
//# sourceMappingURL=app.6754f462.js.map